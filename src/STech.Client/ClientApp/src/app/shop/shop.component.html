<!-- Breadcrumb -->
<div class="breacrumb-section">
  <div class="container">
    <div class="row">
      <div class="col-lg-12">
        <div class="breadcrumb-text product-more">
          <a routerLink="/">
            <i class="fas fa-home mr-1"></i>
            Home
          </a>
          <span>Search Products</span>
        </div>
      </div>
    </div>
  </div>
</div>

<section class="product-shop spad">
  <div class="container">
    <div class="row">
      <!-- Search Filters -->
      <div class="col-lg-3 col-md-6 col-sm-8 order-2 order-lg-1 produts-sidebar-filter">
        <!-- Search Term -->
        <div class="filter-widget">
          <h4 class="fw-title">Search Products</h4>
          <form action="" class="advanced-search">
            <div class="input-group">
              <input #search type="text" placeholder="Search Products">
              <button (click)="onSearch()">
                <i class="fas fa-search"></i>
              </button>
            </div>
          </form>
        </div>

        <!-- Categories Filter -->
        <div class="filter-widget">
          <h4 class="fw-title">Categories</h4>
          <ul class="filter-catagories">
            <li [class.active]="shopParams.categoryID === 0">
              <a class="pointer-cursor" [class.active]="shopParams.categoryID === 0" (click)="onCategorySelected(0)">
                All Categories
              </a>
            </li>

            <li *ngFor="let category of categories" [class.active]="category.category.id === shopParams.categoryID">
              <div>
                <span class="category-count" [class.text-white]="category.category.id === shopParams.categoryID">
                  {{category.category.products.length}}
                </span>
                <div class="category-item-holder" [class.text-white]="category.category.id === shopParams.categoryID">
                  <i class="fas fa-angle-right"></i>
                </div>
                <a class="pointer-cursor" [class.active]="category.category.id === shopParams.categoryID" (click)="onCategorySelected(category.category.id)">
                  {{category.category.name}}
                </a>

                <ul *ngIf="category.children != null && category.children.length > 0" class="sub-categories" style="display: block;">
                  <li *ngFor="let child of category.children" [class.active]="child.id === shopParams.categoryID">
                    <span class="category-count" [class.text-white]="child.id === shopParams.categoryID">
                      {{child.products.length}}
                    </span>
                    <div class="category-item-holder" [class.text-white]="child.id === shopParams.categoryID">
                      <i class="fas fa-angle-double-right"></i>
                    </div>
                    <a class="pointer-cursor" [class.active]="child.id === shopParams.categoryID" (click)="onCategorySelected(child.id)">
                      {{child.name}}
                    </a>
                  </li>
                </ul>

              </div>
            </li>
          </ul>

          <button style="margin-top: 20px" (click)="onReset()" class="filter-btn">Reset</button>
        </div>

      </div>

      <div class="col-lg-9 order-1 order-lg-2">
        <!-- Listing Filters -->
        <div class="product-show-option">
          <div class="row">
            <div class="col-lg-8 col-md-8">
              <div class="select-option">
                <select #selectSortOption class="sorting">
                  <option *ngFor="let sort of sortOptions"
                          [selected]="shopParams.sort === sort.value"
                          [value]="sort.value"
                  >
                    {{sort.name}}
                  </option>
                </select>

                <select #selectPageSize class="p-show">
                  <option *ngFor="let pageSizeOption of pageSizeOptions"
                    [selected]="shopParams.pageSize === pageSizeOption.value"
                    [value]="pageSizeOption.value"
                  >
                    {{pageSizeOption.name}}
                  </option>
                </select>
              </div>
            </div>

            <div class="col-lg-4 col-md-4">
              <p *ngIf="totalCount && totalCount > 0" style="text-align: right">
                Showing
                <strong>
                  {{ (shopParams.pageIndex - 1) * (this.shopParams.pageSize) + 1 }}
                </strong>
                  to
                <strong>
                  {{
                  (shopParams.pageIndex) * (shopParams.pageSize)
                    < totalCount
                    ? (shopParams.pageIndex)
                    * (shopParams.pageSize)
                    : totalCount
                  }}
                </strong>
                of
                <strong>
                  {{totalCount}}
                </strong>
              </p>

              <p *ngIf="totalCount === 0" style="text-align: right">
                Showing <strong>0</strong> products
              </p>
            </div>
          </div>
        </div>

        <!-- Product List -->
        <div *ngIf="totalCount && totalCount > 0" class="product-list">
          <div class="row">
            <div *ngFor="let product of products" class="col-lg-3 col-sm-6">
              <div class="product-item">
                <div class="pi-pic">
                  <img routerLink="/shop/{{product.productID}}" src="{{product.pictureUrls[0]}}" alt="{{product.name}}" class="m-auto">

                  <ul class="itemCartHolder">
                    <li class="w-icon active mr-5"><a routerLink="/shop/{{product.productID}}"><i class="fas fa-eye"></i></a></li>
                    <li class="w-icon active ml-5"><a (click)="addItemToCart(product)"><i class="fas fa-cart-plus"></i></a></li>
                  </ul>
                </div>

                <div class="pi-text">
                  <a routerLink="" class="catagory-name">{{product.categoryName}}</a>
                  <div class="product-price ltr-dir">
                    {{product.price | currency}}
                  </div>
                  <a routerLink="/shop/{{product.productID}}">
                    <h5>{{product.name}}</h5>
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div *ngIf="totalCount === 0" class="alert alert-warning m-0" role="alert">
          No products found
        </div>

        <!-- Pager -->
        <div *ngIf="totalCount > shopParams.pageSize">
          <app-pager
            [pageSize]="this.shopParams.pageSize"
            [totalCount]="this.totalCount"
            [pageIndex]="this.shopParams.pageIndex"
            (pageChanged)="onPageChanged($event)"
          >

          </app-pager>
        </div>
      </div>
    </div>
  </div>
</section>
